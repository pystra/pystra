
<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>pystra.calibration &#8212; PySTRA 1.3.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=992bbb82"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '_modules/pystra/calibration';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/icon_pystra_small.png" class="logo__image only-light" alt="PySTRA 1.3.1 documentation - Home"/>
    <script>document.write(`<img src="../../_static/icon_pystra_small.png" class="logo__image only-dark" alt="PySTRA 1.3.1 documentation - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../install.html">
                        Installation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../tutorial.html">
                        Tutorials
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../api.html">
                        API Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../theory.html">
                        Theoretical Background
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../references.html">
                        References
                      </a>
                    </li>
                
            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../../developer.html">
                        Instructions for Developers
                      </a>
                    </li>
                
                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pystra/pystra" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-github-square fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/ccaprani" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-twitter-square fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Twitter</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../install.html">
                        Installation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../tutorial.html">
                        Tutorials
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../api.html">
                        API Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../theory.html">
                        Theoretical Background
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../references.html">
                        References
                      </a>
                    </li>
                
            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links-2">
                    More
                </button>
                <ul id="pst-nav-more-links-2" class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../../developer.html">
                        Instructions for Developers
                      </a>
                    </li>
                
                </ul>
            </li>
            
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pystra/pystra" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-github-square fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/ccaprani" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-twitter-square fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Twitter</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">Module code</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">pystra.calibration</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <h1>Source code for pystra.calibration</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">fsolve</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.distributions</span><span class="w"> </span><span class="kn">import</span> <span class="n">Constant</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LimitState</span><span class="p">,</span> <span class="n">StochasticModel</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.form</span><span class="w"> </span><span class="kn">import</span> <span class="n">Form</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>


<div class="viewcode-block" id="Calibration"><a class="viewcode-back" href="../../gen/pystra.calibration.Calibration.html#pystra.calibration.Calibration">[docs]</a><span class="k">class</span><span class="w"> </span><span class="nc">Calibration</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Class for calibrating partial and combination factors.</span>

<span class="sd">    The factors are: :math:`\\phi`, :math:`\\gamma`, and :math:`\\psi`</span>
<span class="sd">    factors for a given load combination instance and target reliability.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    betaT : float</span>
<span class="sd">        Target reliability index</span>
<span class="sd">    calib_method : str</span>
<span class="sd">        The calibration algorithm to use</span>
<span class="sd">    cvar : str</span>
<span class="sd">        The label of the calibration variable.</span>
<span class="sd">    df_nom : DataFrame</span>
<span class="sd">        A dataframe of nominal values</span>
<span class="sd">    df_Xstar : DataFrame</span>
<span class="sd">        A dataframe of design point values</span>
<span class="sd">    df_phi : DataFrame</span>
<span class="sd">        A dataframe of partial factors for resistances</span>
<span class="sd">    df_gamma : DataFrame</span>
<span class="sd">        A dataframe of partial factors for loads</span>
<span class="sd">    df_psi : DataFrame</span>
<span class="sd">        A dataframe of load combination factors</span>
<span class="sd">    dict_nom : dict</span>
<span class="sd">        Dictionary of nominal values</span>
<span class="sd">    est_method : str</span>
<span class="sd">        The estimation method</span>
<span class="sd">    label_comb_vrs : str</span>
<span class="sd">        Labels of combination variables</span>
<span class="sd">    label_comb_cases : str</span>
<span class="sd">        Labels of combination load variables</span>
<span class="sd">    label_R : str</span>
<span class="sd">        Labels of resistance variables</span>
<span class="sd">    label_other : str</span>
<span class="sd">        Labels of other load variables</span>
<span class="sd">    label_all : str</span>
<span class="sd">        Labels of all variables including design parameter</span>
<span class="sd">    loadCombObj : LoadCombination</span>
<span class="sd">        LoadCombination object</span>
<span class="sd">    print_output : bool</span>
<span class="sd">        Whether or not to print output to the console</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">loadcombobj</span><span class="p">,</span>
        <span class="n">target_beta</span><span class="p">,</span>
        <span class="n">dict_nom_vals</span><span class="p">,</span>
        <span class="n">calib_var</span><span class="p">,</span>
        <span class="n">calib_method</span><span class="o">=</span><span class="s2">&quot;optimize&quot;</span><span class="p">,</span>
        <span class="n">est_method</span><span class="o">=</span><span class="s2">&quot;matrix&quot;</span><span class="p">,</span>
        <span class="n">print_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize class instance.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        loadcombobj : Class object</span>
<span class="sd">            Class LoadCombination object.</span>
<span class="sd">        target_beta : Float</span>
<span class="sd">            Target reliability index for calibration.</span>
<span class="sd">        dict_nom_vals : Dictionary</span>
<span class="sd">            Dictionary of nominal values.</span>
<span class="sd">        calib_var : String</span>
<span class="sd">            Label of calibration variable in the LSF.</span>
<span class="sd">        calib_method : String, optional</span>
<span class="sd">            Calibration method for the analysis: &quot;optimize&quot; or &quot;alpha&quot;.</span>
<span class="sd">            The default is &quot;optimize&quot;.</span>
<span class="sd">        est_method : String, optional</span>
<span class="sd">            Estimation method for the factors: &quot;matrix&quot; or &quot;coeff&quot;.</span>
<span class="sd">            The default is &quot;matrix&quot;.</span>
<span class="sd">        print_output : Boolean, optional</span>
<span class="sd">            Boolean flag for printing analysis output. The default is False.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Instance attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lc_obj</span> <span class="o">=</span> <span class="n">loadcombobj</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">beta_t</span> <span class="o">=</span> <span class="n">target_beta</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calib_method</span> <span class="o">=</span> <span class="n">calib_method</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">est_method</span> <span class="o">=</span> <span class="n">est_method</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">print_output</span> <span class="o">=</span> <span class="n">print_output</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict_nom</span> <span class="o">=</span> <span class="n">dict_nom_vals</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df_nom</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">dict_nom_vals</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">loadcombobj</span><span class="o">.</span><span class="n">label_comb_cases</span>
        <span class="p">)</span>
        <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">label_R</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">label_other</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">label_comb_vrs</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">label_comb_cases</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">label_all</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_labels</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_S</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_other</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_comb_vrs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cvar</span> <span class="o">=</span> <span class="n">calib_var</span>

    <span class="c1">## Utility Methods</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_print_form_results</span><span class="p">(</span><span class="n">form</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Print the results for a Pystra FORM object</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        form : Pystra FORM object</span>
<span class="sd">            Pystra FORM object after running analysis.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot; </span><span class="se">\n</span><span class="s2"> β = </span><span class="si">{</span><span class="n">form</span><span class="o">.</span><span class="n">getBeta</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2"> α = </span><span class="si">{</span><span class="n">form</span><span class="o">.</span><span class="n">getAlpha</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="se">\</span>
<span class="s2">              </span><span class="se">\n</span><span class="s2"> x* = </span><span class="si">{</span><span class="n">form</span><span class="o">.</span><span class="n">getDesignPoint</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_get_missing_element</span><span class="p">(</span><span class="n">mainlist</span><span class="p">,</span> <span class="n">subsetlist</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Identify the element in the mainlist which is not present in the subset</span>
<span class="sd">        list.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        mainlist : List</span>

<span class="sd">        subsetlist : List</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        missing : List</span>
<span class="sd">            List containing mainlist elements not present in subset list.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">missing</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span> <span class="k">if</span> <span class="n">xx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">subsetlist</span> <span class="k">else</span> <span class="kc">False</span> <span class="k">for</span> <span class="n">xx</span> <span class="ow">in</span> <span class="n">mainlist</span><span class="p">]</span>
        <span class="n">missing</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mainlist</span><span class="p">)[</span><span class="n">missing</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">missing</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_set_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set labels of random variables and load cases based on the</span>
<span class="sd">        LoadCombination class Object.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        label_R : List</span>
<span class="sd">            List of resistance variables.</span>
<span class="sd">        label_other : List</span>
<span class="sd">            List of other load variables.</span>
<span class="sd">        label_comb_vrs : List</span>
<span class="sd">            List of load combination case variables.</span>
<span class="sd">        label_comb_cases : List</span>
<span class="sd">            List of load combination cases.</span>
<span class="sd">        label_all : List</span>
<span class="sd">            List of all random variables.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">label_comb_cases</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lc_obj</span><span class="o">.</span><span class="n">get_label</span><span class="p">(</span><span class="s2">&quot;comb_cases&quot;</span><span class="p">)</span>
        <span class="n">label_R</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lc_obj</span><span class="o">.</span><span class="n">get_label</span><span class="p">(</span><span class="s2">&quot;resist&quot;</span><span class="p">)</span>
        <span class="n">label_comb_vrs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lc_obj</span><span class="o">.</span><span class="n">get_label</span><span class="p">(</span><span class="s2">&quot;comb_vrs&quot;</span><span class="p">)</span>
        <span class="n">label_other</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lc_obj</span><span class="o">.</span><span class="n">get_label</span><span class="p">(</span><span class="s2">&quot;other&quot;</span><span class="p">)</span>
        <span class="n">label_all</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lc_obj</span><span class="o">.</span><span class="n">get_label</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">label_R</span><span class="p">,</span> <span class="n">label_other</span><span class="p">,</span> <span class="n">label_comb_vrs</span><span class="p">,</span> <span class="n">label_comb_cases</span><span class="p">,</span> <span class="n">label_all</span>

<div class="viewcode-block" id="Calibration.calc_lsf_eval_df"><a class="viewcode-back" href="../../gen/pystra.calibration.Calibration.html#pystra.calibration.Calibration.calc_lsf_eval_df">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">calc_lsf_eval_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">ret_abs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate the LSF evaluation of a Dataframe elements.</span>

<span class="sd">        Pass each dataframe value to the LSF and get corresponding LSF</span>
<span class="sd">        evaluation.</span>

<span class="sd">        The columns of the dataframe must be a subset of LSF arguments.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        df : Dataframe</span>
<span class="sd">            Dataframe for element-wise LSF evaluation.</span>
<span class="sd">            len(df.index) can be greater-than or equal to 1</span>
<span class="sd">        ret_abs : Bool, optional</span>
<span class="sd">            Return abs of LSF evaluation. The default is True.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        df_lsf : Dataframe</span>
<span class="sd">            Dataframe containing element-wise LSF evaluation of passed df.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">df_lsf</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="p">:</span>
            <span class="n">jj</span> <span class="o">=</span> <span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lc_obj</span><span class="o">.</span><span class="n">eval_lsf_kwargs</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span> <span class="n">xx</span><span class="p">})</span> <span class="k">for</span> <span class="n">xx</span> <span class="ow">in</span> <span class="n">df_lsf</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
            <span class="p">]</span>
            <span class="n">df_lsf</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span> <span class="k">for</span> <span class="n">xx</span> <span class="ow">in</span> <span class="n">jj</span><span class="p">]</span> <span class="k">if</span> <span class="n">ret_abs</span> <span class="k">else</span> <span class="n">jj</span>
        <span class="k">return</span> <span class="n">df_lsf</span></div>

    <span class="c1">## Projection Methods</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_calibration_optimize</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">rel_func</span><span class="p">,</span>
        <span class="n">z0</span><span class="p">,</span>
        <span class="n">target_beta</span><span class="p">,</span>
        <span class="n">print_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">xtol</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span>
        <span class="n">max_iter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calibrate design parameter for the supplied rel_func to target</span>
<span class="sd">        reliability index using optimization algorithm.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        rel_func : Function</span>
<span class="sd">            Reliability function for the LoadCombination problem parameterized</span>
<span class="sd">            on the load case name and returning a FORM object.</span>
<span class="sd">        z0 : Float</span>
<span class="sd">            Initial value of the design parameter for resistance.</span>
<span class="sd">        target_beta : Float</span>
<span class="sd">            The target reliability index.</span>
<span class="sd">        print_output : Bool, optional</span>
<span class="sd">            Display output for print_outputging. The default is False.</span>
<span class="sd">        xtol : Float, optional</span>
<span class="sd">            Relative error tolerance for convergence. The default is 1e-4.</span>
<span class="sd">        max_iter : Integer, optional</span>
<span class="sd">            Maximum number of iterations for optimizations. The default is</span>
<span class="sd">            as per scipy.optimize.fsolve.</span>
<span class="sd">        **kwargs : Keyword arguments</span>
<span class="sd">            Keyword arguments for rel_func.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Zk_opt : Array</span>
<span class="sd">            Calibrated value of the design parameter for resistance at target_beta.</span>
<span class="sd">        form : Pystra FORM object</span>
<span class="sd">            The form object at beta_t</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cvar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cvar</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">obj_func</span><span class="p">(</span><span class="n">Zk</span><span class="p">,</span> <span class="n">beta_t</span><span class="p">):</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">Constant</span><span class="p">(</span><span class="n">cvar</span><span class="p">,</span> <span class="n">Zk</span><span class="p">)</span>
            <span class="n">dict_z</span> <span class="o">=</span> <span class="p">{</span><span class="n">cvar</span><span class="p">:</span> <span class="n">val</span><span class="p">}</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dict_z</span><span class="p">)</span>
            <span class="n">form</span> <span class="o">=</span> <span class="n">rel_func</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">print_output</span><span class="p">:</span>
                <span class="c1">## Change to inbuilt</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">Zk</span><span class="si">=}</span><span class="s2"> </span><span class="se">\n</span><span class="s2"> β = </span><span class="si">{</span><span class="n">form</span><span class="o">.</span><span class="n">getBeta</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">                      </span><span class="se">\n</span><span class="s2"> α = </span><span class="si">{</span><span class="n">form</span><span class="o">.</span><span class="n">getAlpha</span><span class="p">()</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">                     </span><span class="se">\n</span><span class="s2"> x* = </span><span class="si">{</span><span class="n">form</span><span class="o">.</span><span class="n">getDesignPoint</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
            <span class="k">return</span> <span class="n">beta_t</span> <span class="o">-</span> <span class="n">form</span><span class="o">.</span><span class="n">beta</span>

        <span class="k">if</span> <span class="n">max_iter</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">Zk_opt</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="n">obj_func</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="n">z0</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">target_beta</span><span class="p">),</span> <span class="n">xtol</span><span class="o">=</span><span class="n">xtol</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Zk_opt</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span>
                <span class="n">obj_func</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="n">z0</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">target_beta</span><span class="p">),</span> <span class="n">xtol</span><span class="o">=</span><span class="n">xtol</span><span class="p">,</span> <span class="n">maxfev</span><span class="o">=</span><span class="n">max_iter</span>
            <span class="p">)</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">Constant</span><span class="p">(</span><span class="n">cvar</span><span class="p">,</span> <span class="n">Zk_opt</span><span class="p">)</span>
        <span class="n">dict_z</span> <span class="o">=</span> <span class="p">{</span><span class="n">cvar</span><span class="p">:</span> <span class="n">val</span><span class="p">}</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dict_z</span><span class="p">)</span>
        <span class="n">form</span> <span class="o">=</span> <span class="n">rel_func</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Zk_opt</span><span class="p">,</span> <span class="n">form</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_calibration_alpha</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">rel_func</span><span class="p">,</span>
        <span class="n">z0</span><span class="p">,</span>
        <span class="n">target_beta</span><span class="p">,</span>
        <span class="n">print_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">abstol</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span>
        <span class="n">max_iter</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e2</span><span class="p">),</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calibrate design parameter for the supplied rel_func to target</span>
<span class="sd">        reliability index using iterative :math:`\\alpha` projection method.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        rel_func : Function</span>
<span class="sd">            Reliability function for the LoadCombination problem parameterized</span>
<span class="sd">            on the load case name and returning a FORM object.</span>
<span class="sd">        z0 : Float</span>
<span class="sd">            Initial value of the design parameter for resistance.</span>
<span class="sd">        target_beta : Float</span>
<span class="sd">            The target reliability index.</span>
<span class="sd">        print_output : Bool, optional</span>
<span class="sd">            Display output for print_outputging. The default is False.</span>
<span class="sd">        abstol : Float, optional</span>
<span class="sd">            Absolute error tolerance for convergence. The default is 1e-4.</span>
<span class="sd">        max_iter : Integer, optional</span>
<span class="sd">            Maximum number of iterations. The default 100.</span>
<span class="sd">        **kwargs : Keyword arguments</span>
<span class="sd">            Keyword arguments for rel_func.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Zk_opt : Float</span>
<span class="sd">            Calibrated value of the design parameter for resistance at target_beta.</span>
<span class="sd">        form : Pystra FORM object</span>
<span class="sd">            The form object at beta_t</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">## Initialize algorithm</span>
        <span class="n">cvar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cvar</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">Constant</span><span class="p">(</span><span class="n">cvar</span><span class="p">,</span> <span class="n">z0</span><span class="p">)</span>
        <span class="n">dict_z</span> <span class="o">=</span> <span class="p">{</span><span class="n">cvar</span><span class="p">:</span> <span class="n">val</span><span class="p">}</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dict_z</span><span class="p">)</span>
        <span class="n">form0</span> <span class="o">=</span> <span class="n">rel_func</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">alpha0</span> <span class="o">=</span> <span class="n">form0</span><span class="o">.</span><span class="n">getAlpha</span><span class="p">()</span>
        <span class="n">n_iter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">beta0</span> <span class="o">=</span> <span class="n">form0</span><span class="o">.</span><span class="n">getBeta</span><span class="p">()</span>
        <span class="n">alpha_cal</span> <span class="o">=</span> <span class="n">alpha0</span>
        <span class="n">form_cal</span> <span class="o">=</span> <span class="n">form0</span>
        <span class="n">beta_cal</span> <span class="o">=</span> <span class="n">beta0</span>
        <span class="n">z_cal</span> <span class="o">=</span> <span class="n">z0</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_df_Xstar_labels</span><span class="p">(</span><span class="n">form0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">print_output</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ==== Iteration </span><span class="si">{</span><span class="n">n_iter</span><span class="si">}</span><span class="s2"> ====&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_print_form_results</span><span class="p">(</span><span class="n">form0</span><span class="p">)</span>
        <span class="c1">## Iterate till convergence</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">beta_cal</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta_t</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">abstol</span><span class="p">):</span>
            <span class="c1">## U-space projection</span>
            <span class="n">U_cal</span> <span class="o">=</span> <span class="n">alpha_cal</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta_t</span>
            <span class="c1">## X-space projection</span>
            <span class="n">Xstar_cal</span> <span class="o">=</span> <span class="n">form_cal</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">u_to_x</span><span class="p">(</span>
                <span class="n">U_cal</span><span class="p">,</span> <span class="n">form_cal</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">getMarginalDistributions</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="c1">## Calculate the design parameter for the Calibrated LSF</span>
            <span class="n">dfXst_cal</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">Xstar_cal</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
            <span class="n">z_cal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">calc_design_param_Xst</span><span class="p">(</span><span class="n">dfXst_cal</span><span class="p">)])</span>
            <span class="c1">## Check Calibrated reliability index</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">Constant</span><span class="p">(</span><span class="n">cvar</span><span class="p">,</span> <span class="n">z_cal</span><span class="p">)</span>
            <span class="n">dict_z</span> <span class="o">=</span> <span class="p">{</span><span class="n">cvar</span><span class="p">:</span> <span class="n">val</span><span class="p">}</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dict_z</span><span class="p">)</span>
            <span class="n">form_cal</span> <span class="o">=</span> <span class="n">rel_func</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">beta_cal</span> <span class="o">=</span> <span class="n">form_cal</span><span class="o">.</span><span class="n">getBeta</span><span class="p">()</span>
            <span class="n">alpha_cal</span> <span class="o">=</span> <span class="n">form_cal</span><span class="o">.</span><span class="n">getAlpha</span><span class="p">()</span>
            <span class="c1">## New U-space projection</span>
            <span class="n">U_cal</span> <span class="o">=</span> <span class="n">alpha_cal</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta_t</span>
            <span class="n">n_iter</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1">## Increment number of iterations</span>
            <span class="k">if</span> <span class="n">print_output</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ==== Iteration </span><span class="si">{</span><span class="n">n_iter</span><span class="si">}</span><span class="s2"> ====&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_print_form_results</span><span class="p">(</span><span class="n">form_cal</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> z = </span><span class="si">{</span><span class="n">z_cal</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">n_iter</span> <span class="o">==</span> <span class="n">max_iter</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Maximum iterations </span><span class="si">{</span><span class="n">max_iter</span><span class="si">}</span><span class="s2"> exceeded! Aborting!&quot;</span><span class="p">)</span>
                <span class="k">break</span>
        <span class="k">return</span> <span class="n">z_cal</span><span class="p">,</span> <span class="n">form_cal</span>

<div class="viewcode-block" id="Calibration.calc_design_param_Xst"><a class="viewcode-back" href="../../gen/pystra.calibration.Calibration.html#pystra.calibration.Calibration.calc_design_param_Xst">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">calc_design_param_Xst</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dfXst</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate design parameter for resistance from design points.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dfXst : Dataframe</span>
<span class="sd">            Dataframe containing design points.</span>
<span class="sd">            Note: len(dfXst.index) = 1</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        z : Float</span>
<span class="sd">            design parameter for resistance corresponding to the design pt.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dfS</span> <span class="o">=</span> <span class="n">dfXst</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">label_other</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_comb_vrs</span><span class="p">]</span>
        <span class="n">dfS_dict</span> <span class="o">=</span> <span class="n">dfS</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="s2">&quot;records&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">sum_loadeff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lc_obj</span><span class="o">.</span><span class="n">eval_lsf_kwargs</span><span class="p">(</span><span class="o">**</span><span class="n">dfS_dict</span><span class="p">)</span>
        <span class="n">R_dict</span> <span class="o">=</span> <span class="n">dfXst</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">label_R</span><span class="p">]</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="s2">&quot;records&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">sum_resist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lc_obj</span><span class="o">.</span><span class="n">eval_lsf_kwargs</span><span class="p">(</span><span class="o">**</span><span class="n">R_dict</span><span class="p">)</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">sum_loadeff</span> <span class="o">/</span> <span class="n">sum_resist</span>
        <span class="n">z</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">z</span></div>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_df_Xstar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_form_obj</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get a dataframe of design points in physical space using a list</span>
<span class="sd">        of FORM objects</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        list_form_obj : List</span>
<span class="sd">            List of FORM objects.</span>
<span class="sd">        cols : List or pandas.DataFrame.columns</span>
<span class="sd">            Column values for output Dataframe. Default is</span>
<span class="sd">            list_form_obj[0].model.getNames()[1:]</span>
<span class="sd">        idx : List or pandas.DataFrame.index</span>
<span class="sd">            Index values for output Dataframe. Default is integer array.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dfXstar : Dataframe</span>
<span class="sd">            Dataframe of design points in physical space.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Xstar</span> <span class="o">=</span> <span class="p">[</span><span class="n">xx</span><span class="o">.</span><span class="n">getDesignPoint</span><span class="p">(</span><span class="n">uspace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">for</span> <span class="n">xx</span> <span class="ow">in</span> <span class="n">list_form_obj</span><span class="p">]</span>
        <span class="n">label_vrs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_df_Xstar_labels</span><span class="p">(</span><span class="n">list_form_obj</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">cols</span> <span class="o">=</span> <span class="n">label_vrs</span> <span class="k">if</span> <span class="n">cols</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">cols</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_form_obj</span><span class="p">))</span> <span class="k">if</span> <span class="n">idx</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">idx</span>
        <span class="n">dfXstar</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">Xstar</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">idx</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dfXstar</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_df_Xstar_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">form</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get labels for the DataFrame of design points using the form objects.</span>

<span class="sd">        The Labels contains the [resistance variables + other load variables</span>
<span class="sd">        + load combination variables]</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        form : Object</span>
<span class="sd">            Pystra FORM object.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        label_vrs : list</span>
<span class="sd">            Labels for the DataFrame of design points using the form objects.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">label_const</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">getConstants</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="n">label_all</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">getNames</span><span class="p">()</span>
        <span class="n">label_vrs</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">label_all</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">label_const</span><span class="p">)),</span> <span class="n">key</span><span class="o">=</span><span class="n">label_all</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">label_vrs</span>

<div class="viewcode-block" id="Calibration.run"><a class="viewcode-back" href="../../gen/pystra.calibration.Calibration.html#pystra.calibration.Calibration.run">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">est_method</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">set_max</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Run calibration analysis to estimate :math:`\\phi`, :math:`\\gamma`,</span>
<span class="sd">        and :math:`\\psi` factors, and set class dataframe attributes</span>
<span class="sd">        corresponding to each factor.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        est_method : String, optional</span>
<span class="sd">            Calibration method override. The default is &quot;matrix&quot;.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">est_method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">est_method</span> <span class="k">if</span> <span class="n">est_method</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">est_method</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_calibration</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">est_method</span> <span class="o">==</span> <span class="s2">&quot;coeff&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">df_phi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_gamma</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_psi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_estimate_factors_coeff</span><span class="p">(</span>
                <span class="n">set_max</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">est_method</span> <span class="o">==</span> <span class="s2">&quot;matrix&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">df_phi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_gamma</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_psi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_estimate_factors_matrix</span><span class="p">(</span>
                <span class="n">set_max</span>
            <span class="p">)</span></div>

    <span class="k">def</span><span class="w"> </span><span class="nf">_run_calibration</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Run the method for calibrating the design parameter to the target</span>
<span class="sd">        reliability index.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arr_zcal</span><span class="p">,</span> <span class="n">list_form_cal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calibrate_design_param</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dfXstarcal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_df_Xstar</span><span class="p">(</span>
            <span class="n">list_form_cal</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lc_obj</span><span class="o">.</span><span class="n">label_comb_cases</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dfXstarcal</span><span class="p">[</span><span class="s2">&quot;z&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr_zcal</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_estimate_factors_coeff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">set_max</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Estimate the factors :math:`\\phi`, :math:`\\gamma`, and</span>
<span class="sd">        :math:`\\psi` factors using the coefficient approach.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        set_max : Boolean, optional</span>
<span class="sd">            Set psi estimates to their corresponding max values. The default</span>
<span class="sd">            is False.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        df_phi : Dataframe</span>
<span class="sd">            Dataframe of :math:`\\phi` per load case.</span>
<span class="sd">        df_gamma : Dataframe</span>
<span class="sd">            Dataframe of :math:`\\gamma`.</span>
<span class="sd">        df_psi : Dataframe</span>
<span class="sd">            Dataframe of :math:`\\psi` per load case.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df_phi</span><span class="p">,</span> <span class="n">df_gamma</span><span class="p">,</span> <span class="n">df_psi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_pg_coeff</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dfXstarcal</span><span class="p">,</span> <span class="n">print_output</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">print_output</span>
        <span class="p">)</span>
        <span class="n">df_psi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_psi_max</span><span class="p">(</span><span class="n">df_psi</span><span class="p">)</span> <span class="k">if</span> <span class="n">set_max</span> <span class="k">else</span> <span class="n">df_psi</span>
        <span class="n">df_phi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_phi_min</span><span class="p">(</span><span class="n">df_phi</span><span class="p">)</span> <span class="k">if</span> <span class="n">set_max</span> <span class="k">else</span> <span class="n">df_phi</span>
        <span class="k">return</span> <span class="n">df_phi</span><span class="p">,</span> <span class="n">df_gamma</span><span class="p">,</span> <span class="n">df_psi</span>

<div class="viewcode-block" id="Calibration.get_psi_max"><a class="viewcode-back" href="../../gen/pystra.calibration.Calibration.html#pystra.calibration.Calibration.get_psi_max">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_psi_max</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dfpsi</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get :math:`\\psi` dataframe corresponding to maximum estimates of dfpsi.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dfpsi : DataFrame</span>
<span class="sd">            Dataframe of :math:`\\psi` per load case.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        df_psi_max : DataFrame</span>
<span class="sd">            Dataframe of :math:`\\psi` corresponding to maximum of each load effect.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df_psi_max</span> <span class="o">=</span> <span class="n">dfpsi</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">label_comb_vrs</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">np</span><span class="o">.</span><span class="n">fill_diagonal</span><span class="p">(</span><span class="n">df_psi_max</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="n">df_psi_max</span> <span class="o">=</span> <span class="n">df_psi_max</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">df_psi_max</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">np</span><span class="o">.</span><span class="n">fill_diagonal</span><span class="p">(</span><span class="n">df_psi_max</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label_other</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">df_psi_max</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_other</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfpsi</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">label_other</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">df_psi_max</span></div>

    <span class="k">def</span><span class="w"> </span><span class="nf">_calibrate_design_param</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calibrate design parameter for resistance to target Beta for all</span>
<span class="sd">        load combination cases using the specified projection method. The</span>
<span class="sd">        starting value of the calibration variable is taken as that specified</span>
<span class="sd">        in the LoadCombination object definition.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list_z_cal : List</span>
<span class="sd">            List of calibrated design parameters per load comb case.</span>
<span class="sd">        list_form_cal : List</span>
<span class="sd">            List of calibrated Pystra FORM objects per load comb case.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">startz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lc_obj</span><span class="o">.</span><span class="n">constant</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">cvar</span><span class="p">]</span><span class="o">.</span><span class="n">getValue</span><span class="p">()</span>
        <span class="n">rel_func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lc_obj</span><span class="o">.</span><span class="n">run_reliability_case</span>
        <span class="n">list_z_cal</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">list_form_cal</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">lc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lc_obj</span><span class="o">.</span><span class="n">label_comb_cases</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">calib_method</span> <span class="o">==</span> <span class="s2">&quot;optimize&quot;</span><span class="p">:</span>
                <span class="n">zcal</span><span class="p">,</span> <span class="n">form</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calibration_optimize</span><span class="p">(</span>
                    <span class="n">rel_func</span><span class="p">,</span>
                    <span class="n">z0</span><span class="o">=</span><span class="n">startz</span><span class="p">,</span>
                    <span class="n">print_output</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">print_output</span><span class="p">,</span>
                    <span class="n">target_beta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">beta_t</span><span class="p">,</span>
                    <span class="n">lcn</span><span class="o">=</span><span class="n">lc</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">calib_method</span> <span class="o">==</span> <span class="s2">&quot;alpha&quot;</span><span class="p">:</span>
                <span class="n">zcal</span><span class="p">,</span> <span class="n">form</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calibration_alpha</span><span class="p">(</span>
                    <span class="n">rel_func</span><span class="p">,</span>
                    <span class="n">z0</span><span class="o">=</span><span class="n">startz</span><span class="p">,</span>
                    <span class="n">print_output</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">print_output</span><span class="p">,</span>
                    <span class="n">target_beta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">beta_t</span><span class="p">,</span>
                    <span class="n">lcn</span><span class="o">=</span><span class="n">lc</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="n">list_z_cal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zcal</span><span class="p">)</span>
            <span class="n">list_form_cal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">form</span><span class="p">)</span>
        <span class="n">list_z_cal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">list_z_cal</span><span class="p">)</span>
        <span class="n">arr_beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">xx</span><span class="o">.</span><span class="n">getBeta</span><span class="p">()</span> <span class="k">for</span> <span class="n">xx</span> <span class="ow">in</span> <span class="n">list_form_cal</span><span class="p">])</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_output</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Calibrated reliabilities = </span><span class="si">{</span><span class="n">arr_beta</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">list_z_cal</span><span class="p">,</span> <span class="n">list_form_cal</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_estimate_factors_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">set_max</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Estimate the factors :math:`\\phi`, :math:`\\gamma`, and :math:`\\psi` factors using the</span>
<span class="sd">        Matrix approach.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        df_phi : Dataframe</span>
<span class="sd">            Dataframe of :math:`\\phi` per load case.</span>
<span class="sd">        df_gamma : Dataframe</span>
<span class="sd">            Dataframe of :math:`\\gamma`.</span>
<span class="sd">        df_psi : Dataframe</span>
<span class="sd">            Dataframe of :math:`\\psi`.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df_phi</span><span class="p">,</span> <span class="n">df_gamma</span><span class="p">,</span> <span class="n">df_psi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_pg_matrix</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dfXstarcal</span><span class="p">,</span> <span class="n">print_output</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">print_output</span>
        <span class="p">)</span>
        <span class="n">df_phi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_phi_min</span><span class="p">(</span><span class="n">df_phi</span><span class="p">)</span> <span class="k">if</span> <span class="n">set_max</span> <span class="k">else</span> <span class="n">df_phi</span>
        <span class="n">df_psi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_psi_max</span><span class="p">(</span><span class="n">df_psi</span><span class="p">)</span> <span class="k">if</span> <span class="n">set_max</span> <span class="k">else</span> <span class="n">df_psi</span>
        <span class="k">return</span> <span class="n">df_phi</span><span class="p">,</span> <span class="n">df_gamma</span><span class="p">,</span> <span class="n">df_psi</span>

<div class="viewcode-block" id="Calibration.calc_pg_coeff"><a class="viewcode-back" href="../../gen/pystra.calibration.Calibration.html#pystra.calibration.Calibration.calc_pg_coeff">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">calc_pg_coeff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dfXst</span><span class="p">,</span> <span class="n">print_output</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate :math:`\\phi`, :math:`\\gamma`, and :math:`\\psi` for the given set of design</span>
<span class="sd">        points and nominals using comparison of design pt coefficients approach.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dfXst : Dataframe</span>
<span class="sd">            Dataframe containing all design points at target reliability.</span>
<span class="sd">        print_output : Boolean, optional</span>
<span class="sd">            print_output flag for displaying intermediate and final output of function.</span>
<span class="sd">            The default is False.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        df_phi : Dataframe</span>
<span class="sd">            Dataframe containing :math:`\\phi` estimates for resistance variables</span>
<span class="sd">            per load case.</span>
<span class="sd">        df_gamma : Dataframe</span>
<span class="sd">            Dataframe containing :math:`\\gamma` estimates for all static and</span>
<span class="sd">            combination load variables per load case.</span>
<span class="sd">        df_psi : Dataframe</span>
<span class="sd">            Dataframe containing :math:`\\psi` estimates for all static and</span>
<span class="sd">            combination load variables per load case.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">## Estimate :math:`\\phi` and :math:`\\gamma`</span>
        <span class="n">df_Xst_nom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_Xst_nom</span><span class="p">(</span><span class="n">dfXstar</span><span class="o">=</span><span class="n">dfXst</span><span class="p">)</span>
        <span class="n">df_phi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_phi</span><span class="p">(</span><span class="n">df_Xst_nom</span><span class="p">)</span>
        <span class="n">df_gamma_static</span><span class="p">,</span> <span class="n">df_gamma_comb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_gamma</span><span class="p">(</span><span class="n">df_Xst_nom</span><span class="p">)</span>
        <span class="n">df_gamma</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">df_gamma_static</span><span class="p">,</span> <span class="n">df_gamma_comb</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1">## Estimate :math:`\\psi`</span>
        <span class="n">df_psi</span> <span class="o">=</span> <span class="n">dfXst</span> <span class="o">/</span> <span class="n">df_gamma</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_nom</span>
        <span class="n">df_psi</span> <span class="o">=</span> <span class="n">df_psi</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">label_S</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">print_output</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> $</span><span class="se">\\</span><span class="s2">phi$, </span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">df_phi</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> $</span><span class="se">\\</span><span class="s2">gamma$ static, </span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">df_gamma_static</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> $</span><span class="se">\\</span><span class="s2">gamma$ comb vrs, </span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">df_gamma_comb</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> psi, </span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">df_psi</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">df_phi</span><span class="p">,</span> <span class="n">df_gamma</span><span class="p">,</span> <span class="n">df_psi</span></div>

<div class="viewcode-block" id="Calibration.calc_Xst_nom"><a class="viewcode-back" href="../../gen/pystra.calibration.Calibration.html#pystra.calibration.Calibration.calc_Xst_nom">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">calc_Xst_nom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dfXstar</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate the design point DataFrame divided by the nominal values</span>
<span class="sd">        per load case and adjust for :math:`\\psi` factors for combination</span>
<span class="sd">        load variables.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dfXstar : DataFrame</span>
<span class="sd">            DataFrame containing all design points at target reliability for</span>
<span class="sd">            all load cases.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        df_Xst_nom : DataFrame</span>
<span class="sd">            Design point DataFrame factored by the nominal values</span>
<span class="sd">            per load case.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df_Xst_nom</span> <span class="o">=</span> <span class="n">dfXstar</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_nom</span>

        <span class="c1"># Adjust for :math:`\\psi` factors; replace with non :math:`\\psi`</span>
        <span class="c1"># entries</span>
        <span class="k">for</span> <span class="n">comb</span><span class="p">,</span> <span class="n">vrs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lc_obj</span><span class="o">.</span><span class="n">dict_comb_cases</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">other_combs</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label_comb_cases</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">([</span><span class="n">comb</span><span class="p">])</span>
            <span class="n">gamma</span> <span class="o">=</span> <span class="n">df_Xst_nom</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">comb</span><span class="p">,</span> <span class="n">vrs</span><span class="p">]</span>
            <span class="n">df_Xst_nom</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">other_combs</span><span class="p">),</span> <span class="n">vrs</span><span class="p">]</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">values</span>
        <span class="n">df_Xst_nom</span> <span class="o">=</span> <span class="n">df_Xst_nom</span><span class="p">[</span><span class="n">dfXstar</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">df_Xst_nom</span></div>

<div class="viewcode-block" id="Calibration.calc_phi"><a class="viewcode-back" href="../../gen/pystra.calibration.Calibration.html#pystra.calibration.Calibration.calc_phi">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">calc_phi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dfXstnom</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate resistance factors :math:`\\phi` from a dataframe of design points</span>
<span class="sd">        factored by the nominal values.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dfXstnom : DataFrame</span>
<span class="sd">            Design point DataFrame factored by the nominal values</span>
<span class="sd">            per load case.</span>
<span class="sd">        set_max : Boolean, optional</span>
<span class="sd">            Set :math:`\\phi` estimates to their corresponding max values. The default</span>
<span class="sd">            is False.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        df_phi : DataFrame</span>
<span class="sd">            Resistance factors :math:`\\phi` for resistance variables per load case.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df_phi</span> <span class="o">=</span> <span class="n">dfXstnom</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">label_R</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">df_phi</span></div>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_phi_min</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dfphi_</span><span class="p">):</span>
        <span class="n">dfphi</span> <span class="o">=</span> <span class="n">dfphi_</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">dfphi</span> <span class="o">=</span> <span class="n">dfphi</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">upper</span><span class="o">=</span><span class="n">dfphi</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dfphi</span>

<div class="viewcode-block" id="Calibration.calc_gamma"><a class="viewcode-back" href="../../gen/pystra.calibration.Calibration.html#pystra.calibration.Calibration.calc_gamma">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">calc_gamma</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dfXstnom</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate Load factors :math:`\\gamma` from a dataframe of design points</span>
<span class="sd">        factored by the nominal values.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dfXstnom : DataFrame</span>
<span class="sd">            Design point DataFrame factored by the nominal values</span>
<span class="sd">            per load case.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dfgamma_static : DataFrame</span>
<span class="sd">            Load factors for static variables per load case.</span>
<span class="sd">        dfgamma_comb : DataFrame</span>
<span class="sd">            Load factors for combination variables per load case.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dfgamma_static</span> <span class="o">=</span> <span class="n">dfXstnom</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">label_other</span><span class="p">]</span>
        <span class="n">dfgamma_comb</span> <span class="o">=</span> <span class="n">dfXstnom</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">label_comb_vrs</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">dfgamma_static</span><span class="p">,</span> <span class="n">dfgamma_comb</span></div>

<div class="viewcode-block" id="Calibration.calc_pg_matrix"><a class="viewcode-back" href="../../gen/pystra.calibration.Calibration.html#pystra.calibration.Calibration.calc_pg_matrix">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">calc_pg_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dfXst</span><span class="p">,</span> <span class="n">print_output</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate :math:`\\phi`, :math:`\\gamma`, and :math:`\\psi` for</span>
<span class="sd">        the given set of design points and nominals using the Matrix approach.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dfXst : Dataframe</span>
<span class="sd">            Dataframe containing all design points at target reliability.</span>
<span class="sd">        print_output : Boolean, optional</span>
<span class="sd">            print_output flag for displaying intermediate and final output of function.</span>
<span class="sd">            The default is False.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        df_phi : Dataframe</span>
<span class="sd">            Dataframe containing :math:`\\phi` estimates for resistance variables</span>
<span class="sd">            per load case.</span>
<span class="sd">        df_gamma : Dataframe</span>
<span class="sd">            Dataframe containing :math:`\\gamma` estimates for all static and</span>
<span class="sd">            combination load variables per load case.</span>
<span class="sd">        df_psi : Dataframe</span>
<span class="sd">            Dataframe containing :math:`\\psi` estimates for all static and</span>
<span class="sd">            combination load variables per load case.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">## Estimate :math:`\\phi` and :math:`\\gamma`</span>
        <span class="n">df_Xst_nom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_Xst_nom</span><span class="p">(</span><span class="n">dfXstar</span><span class="o">=</span><span class="n">dfXst</span><span class="p">)</span>
        <span class="n">df_phi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_phi</span><span class="p">(</span><span class="n">df_Xst_nom</span><span class="p">)</span>
        <span class="n">df_gamma_static</span><span class="p">,</span> <span class="n">df_gamma_comb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_gamma</span><span class="p">(</span><span class="n">df_Xst_nom</span><span class="p">)</span>

        <span class="n">df_gamma</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">df_gamma_static</span><span class="p">,</span> <span class="n">df_gamma_comb</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1">## Estimate :math:`\\psi`</span>
        <span class="c1"># Get RHS :math:`\\phi~R~z-\\gamma_g~G-\\gamma_i~S_i`</span>
        <span class="n">phiRz_egS</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_phiRz_egS_vect</span><span class="p">(</span><span class="n">dfXst</span><span class="p">)</span>
        <span class="c1"># Get LHS :math:`\\gamma_j~S_j`</span>
        <span class="n">df_gamma_nom</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_phi</span><span class="p">,</span> <span class="n">df_gamma</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_nom</span>
        <span class="n">epgS_mat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_epgS_mat</span><span class="p">(</span><span class="n">df_gamma_nom</span><span class="p">)</span>
        <span class="c1"># Estimate</span>
        <span class="n">psi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">epgS_mat</span><span class="p">,</span> <span class="n">phiRz_egS</span><span class="p">)</span>
        <span class="n">psi_mat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_psi_row_mat</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label_other</span><span class="p">),</span> <span class="n">psi</span><span class="p">)</span>
        <span class="n">df_psi</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">psi_mat</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">df_gamma</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">df_gamma</span><span class="o">.</span><span class="n">index</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_output</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> $</span><span class="se">\\</span><span class="s2">phi$, </span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">df_phi</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> $</span><span class="se">\\</span><span class="s2">gamma$ static, </span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">df_gamma_static</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> $</span><span class="se">\\</span><span class="s2">gamma$ comb vrs, </span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">df_gamma_comb</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> egS Matrix, </span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">epgS_mat</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> zpR-gS Vector, </span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">phiRz_egS</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> psi, </span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">df_psi</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">df_phi</span><span class="p">,</span> <span class="n">df_gamma</span><span class="p">,</span> <span class="n">df_psi</span></div>

<div class="viewcode-block" id="Calibration.calc_phiRz_egS_vect"><a class="viewcode-back" href="../../gen/pystra.calibration.Calibration.html#pystra.calibration.Calibration.calc_phiRz_egS_vect">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">calc_phiRz_egS_vect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dfXstar</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get RHS for matrix estimation method,</span>
<span class="sd">        :math:`\\phi~R~z-\\gamma_g~G-\\gamma_i~S_i`</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dfXstar : Dataframe</span>
<span class="sd">            Dataframe containing all design points at target reliability.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        phiRz_egS_vect : Array</span>
<span class="sd">            RHS for matrix estimation method as 1D Array.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">## Initialize the vector</span>
        <span class="n">phiRz_egS_vect</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dfXstar</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">comb</span> <span class="ow">in</span> <span class="n">dfXstar</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
            <span class="c1"># Get RVs with cvar except the other combination variable(s)</span>
            <span class="n">s_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lc_obj</span><span class="o">.</span><span class="n">dict_comb_cases</span><span class="p">[</span><span class="n">comb</span><span class="p">]</span>
            <span class="n">s_other</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label_comb_vrs</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">s_label</span><span class="p">)</span>
            <span class="n">label_all_rvs</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">label_R</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_comb_vrs</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_other</span> <span class="o">+</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">cvar</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">list_others</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">label_all_rvs</span><span class="p">)</span> <span class="o">-</span> <span class="n">s_other</span><span class="p">)</span>
            <span class="c1"># Pass RVs except the other combination variable(s) to the LSF</span>
            <span class="n">dfXstar_dict</span> <span class="o">=</span> <span class="n">dfXstar</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="n">comb</span><span class="p">],</span> <span class="n">list_others</span><span class="p">]</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="s2">&quot;records&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">phiRz_egS_vect</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lc_obj</span><span class="o">.</span><span class="n">eval_lsf_kwargs</span><span class="p">(</span><span class="o">**</span><span class="n">dfXstar_dict</span><span class="p">)</span>
            <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">phiRz_egS_vect</span></div>

<div class="viewcode-block" id="Calibration.calc_epgS_mat"><a class="viewcode-back" href="../../gen/pystra.calibration.Calibration.html#pystra.calibration.Calibration.calc_epgS_mat">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">calc_epgS_mat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dfgammanom</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get LHS for matrix estimation method, :math:`\\gamma_j~S_j`.</span>
<span class="sd">        The LHS is evaluated by evaluating the LSF with appropriate random</span>
<span class="sd">        variables to account for any constant multipliers. The implementation</span>
<span class="sd">        works for both, linear and non-linear LSFs. For more algorithmic</span>
<span class="sd">        details, ref to Appendix A, Caprani and Khan, Structural Safety, 2023.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dfgammanom : Dataframe</span>
<span class="sd">            Dataframe containing product of nominal values and safety factors,</span>
<span class="sd">            along with calibrated z values.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        epgS_mat : Array</span>
<span class="sd">            LHS for matrix estimation method as 2D Array.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1">## Initialize the vector</span>
        <span class="n">epgS_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">dfgammanom</span><span class="o">.</span><span class="n">index</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label_comb_vrs</span><span class="p">)))</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">comb</span> <span class="ow">in</span> <span class="n">dfgammanom</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
            <span class="c1"># Get load comb RV with other RVs</span>
            <span class="n">s_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lc_obj</span><span class="o">.</span><span class="n">dict_comb_cases</span><span class="p">[</span><span class="n">comb</span><span class="p">]</span>
            <span class="n">rvs_for_lhs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label_other</span><span class="p">)</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="n">s_label</span><span class="p">))</span>
            <span class="c1"># Pass load comb RV with other RVs to the LSF</span>
            <span class="n">dfXstar_dict_comb</span> <span class="o">=</span> <span class="n">dfgammanom</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="n">comb</span><span class="p">],</span> <span class="n">rvs_for_lhs</span><span class="p">]</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="s2">&quot;records&quot;</span><span class="p">)[</span>
                <span class="mi">0</span>
            <span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label_other</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">dfXstar_dict_other</span> <span class="o">=</span> <span class="n">dfgammanom</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="n">comb</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_other</span><span class="p">]</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span>
                    <span class="s2">&quot;records&quot;</span>
                <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dfXstar_dict_other</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">epgS_mat</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lc_obj</span><span class="o">.</span><span class="n">eval_lsf_kwargs</span><span class="p">(</span>
                <span class="o">**</span><span class="n">dfXstar_dict_comb</span>
            <span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">lc_obj</span><span class="o">.</span><span class="n">eval_lsf_kwargs</span><span class="p">(</span><span class="o">**</span><span class="n">dfXstar_dict_other</span><span class="p">)</span>
            <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">epgS_mat</span> <span class="o">=</span> <span class="n">epgS_mat</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">np</span><span class="o">.</span><span class="n">fill_diagonal</span><span class="p">(</span><span class="n">epgS_mat</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">epgS_mat</span></div>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_psi_row_mat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_other_vrs</span><span class="p">,</span> <span class="n">psi_comb_vrs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert :math:`\\psi` estimates for load case variables into :math:`\\psi` matrix for all</span>
<span class="sd">        random variables (including non load case, i.e. other, variables). Each</span>
<span class="sd">        row of the output matrix corresponds to one set of :math:`\\psi` for all rvs</span>
<span class="sd">        for a load case. The value of :math:`\\psi` for non load case rvs is set to be 1.0.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        num_other_vrs : Integer</span>
<span class="sd">            Number of other random variables (i.e. load effects not part of load</span>
<span class="sd">                                              combinations).</span>
<span class="sd">        psi_comb_vrs : Array or Ndarray</span>
<span class="sd">            If :math:`\\psi` is specified for all load combinations, then Array.</span>
<span class="sd">            If :math:`\\psi` is specified per load combination, then Ndrray Matrix.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        psi_row_mat_ : Ndarray</span>
<span class="sd">            :math:`\\psi` Matrix for all rvs and combinations. Each row of Matrix</span>
<span class="sd">            corresponds to one set of :math:`\\psi` for all rvs for a load case.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">num_comb_vrs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">psi_comb_vrs</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">psi_comb_vrs</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">psi_row_mat_comb</span> <span class="o">=</span> <span class="n">psi_comb_vrs</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">num_comb_vrs</span><span class="p">,</span> <span class="n">num_comb_vrs</span><span class="p">))</span>
            <span class="n">np</span><span class="o">.</span><span class="n">fill_diagonal</span><span class="p">(</span><span class="n">psi_row_mat_comb</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">psi_row_mat_comb</span> <span class="o">=</span> <span class="n">psi_comb_vrs</span>
        <span class="n">psi_row_mat_other</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">num_comb_vrs</span><span class="p">,</span> <span class="n">num_other_vrs</span><span class="p">))</span>
        <span class="n">psi_row_mat_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">psi_row_mat_other</span><span class="p">,</span> <span class="n">psi_row_mat_comb</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">psi_row_mat_</span>

    <span class="c1"># Projection Method</span>

<div class="viewcode-block" id="Calibration.calc_beta_design_param"><a class="viewcode-back" href="../../gen/pystra.calibration.Calibration.html#pystra.calibration.Calibration.calc_beta_design_param">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">calc_beta_design_param</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">design_z</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate reliabilities based on given design parameter for resistance</span>
<span class="sd">        for all load combination cases.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        design_z : Float</span>
<span class="sd">            design parameter for resistance</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        arr_beta : Array</span>
<span class="sd">            Array containing reliability indices corresponding to design_z for</span>
<span class="sd">            each load combination case.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cvar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cvar</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">Constant</span><span class="p">(</span><span class="n">cvar</span><span class="p">,</span> <span class="n">design_z</span><span class="p">)</span>
        <span class="n">dict_z</span> <span class="o">=</span> <span class="p">{</span><span class="n">cvar</span><span class="p">:</span> <span class="n">val</span><span class="p">}</span>
        <span class="n">list_form_des</span> <span class="o">=</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lc_obj</span><span class="o">.</span><span class="n">run_reliability_case</span><span class="p">(</span><span class="n">lcn</span><span class="o">=</span><span class="n">xx</span><span class="p">,</span> <span class="o">**</span><span class="n">dict_z</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">xx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lc_obj</span><span class="o">.</span><span class="n">label_comb_cases</span>
        <span class="p">]</span>
        <span class="n">arr_beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">xx</span><span class="o">.</span><span class="n">getBeta</span><span class="p">()</span> <span class="k">for</span> <span class="n">xx</span> <span class="ow">in</span> <span class="n">list_form_des</span><span class="p">])</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_output</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Design reliabilities = </span><span class="si">{</span><span class="n">arr_beta</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">arr_beta</span></div>

<div class="viewcode-block" id="Calibration.calc_df_pgRS"><a class="viewcode-back" href="../../gen/pystra.calibration.Calibration.html#pystra.calibration.Calibration.calc_df_pgRS">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">calc_df_pgRS</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">min_phi</span><span class="p">,</span> <span class="n">max_psi</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate the DataFrame of all resistance and load variables nominal</span>
<span class="sd">        values multiplied by their respective factors, :math:`\\phi`, :math:`\\gamma`,</span>
<span class="sd">        and :math:`\\psi`, for all load cases.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        df_pgRS : DataFrame</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df_pgRS</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_nom</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">df_phi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_phi_min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df_phi</span><span class="p">)</span> <span class="k">if</span> <span class="n">min_phi</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_phi</span>
        <span class="n">df_psi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_psi_max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df_psi</span><span class="p">)</span> <span class="k">if</span> <span class="n">max_psi</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_psi</span>
        <span class="n">df_gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_gamma</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">df_pgRS</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_S</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_pgRS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">label_S</span><span class="p">]</span> <span class="o">*</span> <span class="n">df_gamma</span> <span class="o">*</span> <span class="n">df_psi</span>
        <span class="n">df_pgRS</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_R</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_pgRS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">label_R</span><span class="p">]</span> <span class="o">*</span> <span class="n">df_phi</span>
        <span class="k">return</span> <span class="n">df_pgRS</span></div>

<div class="viewcode-block" id="Calibration.get_design_param_factor"><a class="viewcode-back" href="../../gen/pystra.calibration.Calibration.html#pystra.calibration.Calibration.get_design_param_factor">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_design_param_factor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">min_phi</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">max_psi</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Estimate the resistance design parameter for a given set of safety and</span>
<span class="sd">        combination factors, and nominals.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        array_z : Array</span>
<span class="sd">            Array containing design parameters for all load combination cases.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df_pgRS</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_df_pgRS</span><span class="p">(</span><span class="n">min_phi</span><span class="p">,</span> <span class="n">max_psi</span><span class="p">)</span>
        <span class="n">list_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">df_pgRS</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="n">xx</span><span class="p">],</span> <span class="p">:]</span> <span class="k">for</span> <span class="n">xx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_comb_cases</span><span class="p">]</span>
        <span class="n">array_z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">calc_design_param_Xst</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span> <span class="k">for</span> <span class="n">xx</span> <span class="ow">in</span> <span class="n">list_cols</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">array_z</span></div>

<div class="viewcode-block" id="Calibration.print_detailed_output"><a class="viewcode-back" href="../../gen/pystra.calibration.Calibration.html#pystra.calibration.Calibration.print_detailed_output">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">print_detailed_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Print detailed outputs for Pystra Calibration, including calculations</span>
<span class="sd">        from intermediate steps.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        precision : float, optional</span>
<span class="sd">            Decimal precision for roundingo off output. The default is 2.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="mi">54</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="n">n</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;X* = </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dfXstarcal</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">precision</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">phi = &quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_phi</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">precision</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">gamma =&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_gamma</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">precision</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">psi = &quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_psi</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">precision</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="n">n</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="GenericModel"><a class="viewcode-back" href="../../gen/pystra.calibration.GenericModel.html#pystra.calibration.GenericModel">[docs]</a><span class="k">class</span><span class="w"> </span><span class="nc">GenericModel</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A probability model for generic calibration.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the class which holds all the probability model info.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phi</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma_g</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma_q</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma_p</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wR</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wS</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">G</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">P</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Q</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Rk</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Gk</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Pk</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Qk</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="GenericModel.set_factors"><a class="viewcode-back" href="../../gen/pystra.calibration.GenericModel.html#pystra.calibration.GenericModel.set_factors">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_factors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">gamma_g</span><span class="p">,</span> <span class="n">gamma_p</span><span class="p">,</span> <span class="n">gamma_q</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Assign the partial factors to the generic probability model.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        phi : float</span>
<span class="sd">            Capacity reduction factor.</span>
<span class="sd">        gamma_g : float</span>
<span class="sd">            Dead load factor.</span>
<span class="sd">        gamma_p : float</span>
<span class="sd">            Permanent load factor.</span>
<span class="sd">        gamma_q : float</span>
<span class="sd">            Live load factor.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phi</span> <span class="o">=</span> <span class="n">phi</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma_g</span> <span class="o">=</span> <span class="n">gamma_g</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma_p</span> <span class="o">=</span> <span class="n">gamma_p</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma_q</span> <span class="o">=</span> <span class="n">gamma_q</span></div>

<div class="viewcode-block" id="GenericModel.set_distributions"><a class="viewcode-back" href="../../gen/pystra.calibration.GenericModel.html#pystra.calibration.GenericModel.set_distributions">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_distributions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wR</span><span class="p">,</span> <span class="n">wS</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">Q</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Assign the PySTRA distribution objects</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        wR : PySTRA distribution object</span>
<span class="sd">            Model error for resistance.</span>
<span class="sd">        wS : PySTRA distribution object</span>
<span class="sd">            Model error for loading/analysis.</span>
<span class="sd">        R : PySTRA distribution object</span>
<span class="sd">            Resistance distribution.</span>
<span class="sd">        G : PySTRA distribution object</span>
<span class="sd">            Dead load distribution.</span>
<span class="sd">        P : PySTRA distribution object</span>
<span class="sd">            Permanent load distribution.</span>
<span class="sd">        Q : PySTRA distribution object</span>
<span class="sd">            Live load distribution.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wR</span> <span class="o">=</span> <span class="n">wR</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wS</span> <span class="o">=</span> <span class="n">wS</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">=</span> <span class="n">R</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">G</span> <span class="o">=</span> <span class="n">G</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">P</span> <span class="o">=</span> <span class="n">P</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Q</span> <span class="o">=</span> <span class="n">Q</span></div>

<div class="viewcode-block" id="GenericModel.set_nominals"><a class="viewcode-back" href="../../gen/pystra.calibration.GenericModel.html#pystra.calibration.GenericModel.set_nominals">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_nominals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Rk</span><span class="p">,</span> <span class="n">Gk</span><span class="p">,</span> <span class="n">Pk</span><span class="p">,</span> <span class="n">Qk</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the nominal values of the parameters for use in design.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        Rk : float</span>
<span class="sd">            Characteristic value of resistance.</span>
<span class="sd">        Gk : float</span>
<span class="sd">            Characteristic value of dead load.</span>
<span class="sd">        Pk : float</span>
<span class="sd">            Characteristic value of permanent load.</span>
<span class="sd">        Qk : float</span>
<span class="sd">            Characteristic value of live load.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Rk</span> <span class="o">=</span> <span class="n">Rk</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Gk</span> <span class="o">=</span> <span class="n">Gk</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Pk</span> <span class="o">=</span> <span class="n">Pk</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Qk</span> <span class="o">=</span> <span class="n">Qk</span></div>

<div class="viewcode-block" id="GenericModel.set_model_errors"><a class="viewcode-back" href="../../gen/pystra.calibration.GenericModel.html#pystra.calibration.GenericModel.set_model_errors">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_model_errors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wR</span><span class="p">,</span> <span class="n">wS</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the model errors</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        wR : PySTRA distribution object</span>
<span class="sd">            Model error for resistance.</span>
<span class="sd">        wS : PySTRA distribution object</span>
<span class="sd">            Model error for loading/analysis.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">wR</span> <span class="o">=</span> <span class="n">wR</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wS</span> <span class="o">=</span> <span class="n">wS</span></div>

<div class="viewcode-block" id="GenericModel.set_resistance_params"><a class="viewcode-back" href="../../gen/pystra.calibration.GenericModel.html#pystra.calibration.GenericModel.set_resistance_params">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_resistance_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">Rk</span><span class="p">,</span> <span class="n">phi</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the resistance model parameters.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        R : PySTRA distribution object</span>
<span class="sd">            Resistance distribution.</span>
<span class="sd">        Rk : float</span>
<span class="sd">            Characteristic value of resistance.</span>
<span class="sd">        phi : float</span>
<span class="sd">            Capacity reduction factor.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">=</span> <span class="n">R</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Rk</span> <span class="o">=</span> <span class="n">Rk</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phi</span> <span class="o">=</span> <span class="n">phi</span></div>

<div class="viewcode-block" id="GenericModel.set_dead_params"><a class="viewcode-back" href="../../gen/pystra.calibration.GenericModel.html#pystra.calibration.GenericModel.set_dead_params">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_dead_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">Gk</span><span class="p">,</span> <span class="n">gamma_g</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the dead load model parameters.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        G : PySTRA distribution object</span>
<span class="sd">            Dead load distribution.</span>
<span class="sd">        Gk : float</span>
<span class="sd">            Characteristic value of dead load.</span>
<span class="sd">        gamma_g : float</span>
<span class="sd">            Partial factor for dead load.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">G</span> <span class="o">=</span> <span class="n">G</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Gk</span> <span class="o">=</span> <span class="n">Gk</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma_g</span> <span class="o">=</span> <span class="n">gamma_g</span></div>

<div class="viewcode-block" id="GenericModel.set_permanent_params"><a class="viewcode-back" href="../../gen/pystra.calibration.GenericModel.html#pystra.calibration.GenericModel.set_permanent_params">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_permanent_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">Pk</span><span class="p">,</span> <span class="n">gamma_p</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the permanent load model parameters.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        P : PySTRA distribution object</span>
<span class="sd">            Permanent load distribution.</span>
<span class="sd">        Pk : float</span>
<span class="sd">            Characteristic value of permanent load.</span>
<span class="sd">        gamma_p : float</span>
<span class="sd">            Partial factor for permanent load.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">P</span> <span class="o">=</span> <span class="n">P</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Pk</span> <span class="o">=</span> <span class="n">Pk</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma_p</span> <span class="o">=</span> <span class="n">gamma_p</span></div>

<div class="viewcode-block" id="GenericModel.set_live_params"><a class="viewcode-back" href="../../gen/pystra.calibration.GenericModel.html#pystra.calibration.GenericModel.set_live_params">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_live_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">Qk</span><span class="p">,</span> <span class="n">gamma_q</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the dead load model parameters.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        Q : PySTRA distribution object</span>
<span class="sd">            Live load distribution.</span>
<span class="sd">        Qk : float</span>
<span class="sd">            Characteristic value of live load.</span>
<span class="sd">        gamma_q : float</span>
<span class="sd">            Partial factor for live load.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Q</span> <span class="o">=</span> <span class="n">Q</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Qk</span> <span class="o">=</span> <span class="n">Qk</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma_q</span> <span class="o">=</span> <span class="n">gamma_q</span></div>

<div class="viewcode-block" id="GenericModel.get"><a class="viewcode-back" href="../../gen/pystra.calibration.GenericModel.html#pystra.calibration.GenericModel.get">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a tuple of all the probability model parameters</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        phi : float</span>
<span class="sd">            Capacity reduction factor.</span>
<span class="sd">        gamma_g : float</span>
<span class="sd">            Dead load factor.</span>
<span class="sd">        gamma_p : float</span>
<span class="sd">            Permanent load factor.</span>
<span class="sd">        gamma_q : float</span>
<span class="sd">            Live load factor.</span>
<span class="sd">        wR : PySTRA distribution object</span>
<span class="sd">            Model error for resistance.</span>
<span class="sd">        wS : PySTRA distribution object</span>
<span class="sd">            Model error for loading/analysis.</span>
<span class="sd">        R : PySTRA distribution object</span>
<span class="sd">            Resistance distribution.</span>
<span class="sd">        G : PySTRA distribution object</span>
<span class="sd">            Dead load distribution.</span>
<span class="sd">        P : PySTRA distribution object</span>
<span class="sd">            Permanent load distribution.</span>
<span class="sd">        Q : PySTRA distribution object</span>
<span class="sd">            Live load distribution.</span>
<span class="sd">        Rk : float</span>
<span class="sd">            Characteristic value of resistance.</span>
<span class="sd">        Gk : float</span>
<span class="sd">            Characteristic value of dead load.</span>
<span class="sd">        Pk : float</span>
<span class="sd">            Characteristic value of permanent load.</span>
<span class="sd">        Qk : float</span>
<span class="sd">            Characteristic value of live load.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gamma_g</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gamma_p</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gamma_q</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wR</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wS</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">G</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Q</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Rk</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Gk</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Pk</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Qk</span><span class="p">,</span>
        <span class="p">)</span></div></div>


<div class="viewcode-block" id="GenericCalibration"><a class="viewcode-back" href="../../gen/pystra.calibration.GenericCalibration.html#pystra.calibration.GenericCalibration">[docs]</a><span class="k">class</span><span class="w"> </span><span class="nc">GenericCalibration</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A generic code calibration</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aq_points</span><span class="p">,</span> <span class="n">ag_points</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the generic code calibration class with the calculation points.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q_points : nd.array</span>
<span class="sd">            The grid of points to use for the live load ratio.</span>
<span class="sd">        g_points : nd.array</span>
<span class="sd">            The grid of points to use for the dead load ratio.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aq_points</span> <span class="o">=</span> <span class="n">aq_points</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ag_points</span> <span class="o">=</span> <span class="n">ag_points</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prob_models</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_analysed</span> <span class="o">=</span> <span class="kc">False</span>

<div class="viewcode-block" id="GenericCalibration.add_model"><a class="viewcode-back" href="../../gen/pystra.calibration.GenericCalibration.html#pystra.calibration.GenericCalibration.add_model">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a probability model to the calibration.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        model : GenericModel object</span>
<span class="sd">            A probability model.</span>
<span class="sd">        color : str</span>
<span class="sd">            Matplotlib string representation of a colour for plotting.</span>
<span class="sd">        label : str</span>
<span class="sd">            Label for use in plot legend.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_analysed</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">model_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="n">model</span><span class="p">,</span> <span class="s2">&quot;betas&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">color</span><span class="p">,</span> <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="n">label</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prob_models</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model_dict</span><span class="p">)</span></div>

<div class="viewcode-block" id="GenericCalibration.lsf"><a class="viewcode-back" href="../../gen/pystra.calibration.GenericCalibration.html#pystra.calibration.GenericCalibration.lsf">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">lsf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">aq</span><span class="p">,</span> <span class="n">ag</span><span class="p">,</span> <span class="n">wR</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">wS</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">Q</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Limit state function for the generic code calibration problem.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : float</span>
<span class="sd">            Design parameter.</span>
<span class="sd">        aq : float</span>
<span class="sd">            Ratio of live to total loads.</span>
<span class="sd">        ag : float</span>
<span class="sd">            Ratio of dead to total dead and permanent load.</span>
<span class="sd">        wR : float</span>
<span class="sd">            Model error for resistance.</span>
<span class="sd">        R : float</span>
<span class="sd">            Normalized resistance.</span>
<span class="sd">        wS : float</span>
<span class="sd">            Model error for loading/analysis.</span>
<span class="sd">        G : float</span>
<span class="sd">            Normalized dead load.</span>
<span class="sd">        P : float</span>
<span class="sd">            Normalized permanent load.</span>
<span class="sd">        Q : float</span>
<span class="sd">            Normalized live load.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            Evaluation of the limit state.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">z</span> <span class="o">*</span> <span class="n">wR</span> <span class="o">*</span> <span class="n">R</span> <span class="o">-</span> <span class="n">wS</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">aq</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">ag</span> <span class="o">*</span> <span class="n">G</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">ag</span><span class="p">)</span> <span class="o">*</span> <span class="n">P</span><span class="p">)</span> <span class="o">+</span> <span class="n">aq</span> <span class="o">*</span> <span class="n">Q</span><span class="p">)</span></div>

<div class="viewcode-block" id="GenericCalibration.design"><a class="viewcode-back" href="../../gen/pystra.calibration.GenericCalibration.html#pystra.calibration.GenericCalibration.design">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">design</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aq</span><span class="p">,</span> <span class="n">ag</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">gamma_g</span><span class="p">,</span> <span class="n">gamma_p</span><span class="p">,</span> <span class="n">gamma_q</span><span class="p">,</span> <span class="n">Rk</span><span class="p">,</span> <span class="n">Gk</span><span class="p">,</span> <span class="n">Pk</span><span class="p">,</span> <span class="n">Qk</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Do a structural design for z, the design parameter, based on the code rules.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        aq : float</span>
<span class="sd">            Ratio of live to total loads.</span>
<span class="sd">        ag : float</span>
<span class="sd">            Ratio of dead to total dead and permanent load.</span>
<span class="sd">        phi : float</span>
<span class="sd">            Capacity reduction factor.</span>
<span class="sd">        gamma_g : float</span>
<span class="sd">            Dead load factor.</span>
<span class="sd">        gamma_p : float</span>
<span class="sd">            Permanent load factor.</span>
<span class="sd">        gamma_q : float</span>
<span class="sd">            Live load factor.</span>
<span class="sd">        Rk : float</span>
<span class="sd">            Characteristic value of resistance.</span>
<span class="sd">        Gk : float</span>
<span class="sd">            Characteristic value of dead load.</span>
<span class="sd">        Pk : float</span>
<span class="sd">            Characteristic value of permanent load.</span>
<span class="sd">        Qk : float</span>
<span class="sd">            Characteristic value of live load.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        z : float</span>
<span class="sd">            Design parameter.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">phi</span> <span class="o">*</span> <span class="n">Rk</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span>
            <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">aq</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">ag</span> <span class="o">*</span> <span class="n">gamma_g</span> <span class="o">*</span> <span class="n">Gk</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">ag</span><span class="p">)</span> <span class="o">*</span> <span class="n">gamma_p</span> <span class="o">*</span> <span class="n">Pk</span><span class="p">)</span> <span class="o">+</span> <span class="n">aq</span> <span class="o">*</span> <span class="n">gamma_q</span> <span class="o">*</span> <span class="n">Qk</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">z</span></div>

<div class="viewcode-block" id="GenericCalibration.analyse_design"><a class="viewcode-back" href="../../gen/pystra.calibration.GenericCalibration.html#pystra.calibration.GenericCalibration.analyse_design">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">analyse_design</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">aq</span><span class="p">,</span> <span class="n">ag</span><span class="p">,</span> <span class="n">wR</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">wS</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">Q</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reliability analysis of the design according to the code rules.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : float</span>
<span class="sd">            Design parameter.</span>
<span class="sd">        aq : float</span>
<span class="sd">            Ratio of live to total loads.</span>
<span class="sd">        ag : float</span>
<span class="sd">            Ratio of dead to total dead and permanent load.</span>
<span class="sd">        wR : float</span>
<span class="sd">            Model error for resistance.</span>
<span class="sd">        R : float</span>
<span class="sd">            Normalized resistance.</span>
<span class="sd">        wS : float</span>
<span class="sd">            Model error for loading/analysis.</span>
<span class="sd">        G : float</span>
<span class="sd">            Normalized dead load.</span>
<span class="sd">        P : float</span>
<span class="sd">            Normalized permanent load.</span>
<span class="sd">        Q : float</span>
<span class="sd">            Normalized live load.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            The reliability index, beta.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">limit_state</span> <span class="o">=</span> <span class="n">LimitState</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lsf</span><span class="p">)</span>

        <span class="n">stochastic_model</span> <span class="o">=</span> <span class="n">StochasticModel</span><span class="p">()</span>
        <span class="n">stochastic_model</span><span class="o">.</span><span class="n">addVariable</span><span class="p">(</span><span class="n">wR</span><span class="p">)</span>
        <span class="n">stochastic_model</span><span class="o">.</span><span class="n">addVariable</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
        <span class="n">stochastic_model</span><span class="o">.</span><span class="n">addVariable</span><span class="p">(</span><span class="n">wS</span><span class="p">)</span>
        <span class="n">stochastic_model</span><span class="o">.</span><span class="n">addVariable</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
        <span class="n">stochastic_model</span><span class="o">.</span><span class="n">addVariable</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
        <span class="n">stochastic_model</span><span class="o">.</span><span class="n">addVariable</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>

        <span class="n">stochastic_model</span><span class="o">.</span><span class="n">addVariable</span><span class="p">(</span><span class="n">Constant</span><span class="p">(</span><span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="n">z</span><span class="p">))</span>
        <span class="n">stochastic_model</span><span class="o">.</span><span class="n">addVariable</span><span class="p">(</span><span class="n">Constant</span><span class="p">(</span><span class="s2">&quot;aq&quot;</span><span class="p">,</span> <span class="n">aq</span><span class="p">))</span>
        <span class="n">stochastic_model</span><span class="o">.</span><span class="n">addVariable</span><span class="p">(</span><span class="n">Constant</span><span class="p">(</span><span class="s2">&quot;ag&quot;</span><span class="p">,</span> <span class="n">ag</span><span class="p">))</span>

        <span class="n">form</span> <span class="o">=</span> <span class="n">Form</span><span class="p">(</span>
            <span class="n">stochastic_model</span><span class="o">=</span><span class="n">stochastic_model</span><span class="p">,</span>
            <span class="n">limit_state</span><span class="o">=</span><span class="n">limit_state</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">form</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">form</span><span class="o">.</span><span class="n">getBeta</span><span class="p">()</span></div>

<div class="viewcode-block" id="GenericCalibration.get_reliabilities"><a class="viewcode-back" href="../../gen/pystra.calibration.GenericCalibration.html#pystra.calibration.GenericCalibration.get_reliabilities">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_reliabilities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Aq</span><span class="p">,</span> <span class="n">Ag</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determine the reliabilities across the full range of dead and live load ratios.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        Aq : nd.array</span>
<span class="sd">            The grid of live load ratio points.</span>
<span class="sd">        Ag : nd.array</span>
<span class="sd">            The grid of dead load ratio points.</span>
<span class="sd">        model : GenericModel</span>
<span class="sd">            Probability model and code rules for analysis.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        beta : nd.array</span>
<span class="sd">            Reliability indices at each dead and live load ratio grid point.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Ag</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">Aq</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ag</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Ag</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">aq</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Aq</span><span class="p">):</span>
                <span class="p">(</span>
                    <span class="n">phi</span><span class="p">,</span>
                    <span class="n">gamma_g</span><span class="p">,</span>
                    <span class="n">gamma_p</span><span class="p">,</span>
                    <span class="n">gamma_q</span><span class="p">,</span>
                    <span class="n">wR</span><span class="p">,</span>
                    <span class="n">wS</span><span class="p">,</span>
                    <span class="n">R</span><span class="p">,</span>
                    <span class="n">G</span><span class="p">,</span>
                    <span class="n">P</span><span class="p">,</span>
                    <span class="n">Q</span><span class="p">,</span>
                    <span class="n">Rk</span><span class="p">,</span>
                    <span class="n">Gk</span><span class="p">,</span>
                    <span class="n">Pk</span><span class="p">,</span>
                    <span class="n">Qk</span><span class="p">,</span>
                <span class="p">)</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
                <span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">design</span><span class="p">(</span><span class="n">aq</span><span class="p">,</span> <span class="n">ag</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">gamma_g</span><span class="p">,</span> <span class="n">gamma_p</span><span class="p">,</span> <span class="n">gamma_q</span><span class="p">,</span> <span class="n">Rk</span><span class="p">,</span> <span class="n">Gk</span><span class="p">,</span> <span class="n">Pk</span><span class="p">,</span> <span class="n">Qk</span><span class="p">)</span>
                <span class="n">beta</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyse_design</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">aq</span><span class="p">,</span> <span class="n">ag</span><span class="p">,</span> <span class="n">wR</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">wS</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">beta</span></div>

<div class="viewcode-block" id="GenericCalibration.analyse"><a class="viewcode-back" href="../../gen/pystra.calibration.GenericCalibration.html#pystra.calibration.GenericCalibration.analyse">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">analyse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Analyse the code calibration problem given the probability models.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If there are no probability models assigned.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">prob_models</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No probability models assigned&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">pm</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">prob_models</span><span class="p">:</span>
            <span class="n">pm</span><span class="p">[</span><span class="s2">&quot;betas&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_reliabilities</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">aq_points</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ag_points</span><span class="p">,</span> <span class="n">pm</span><span class="p">[</span><span class="s2">&quot;model&quot;</span><span class="p">]</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">is_analysed</span> <span class="o">=</span> <span class="kc">True</span></div>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_range</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">xl</span><span class="p">,</span> <span class="n">xu</span><span class="p">,</span> <span class="n">ytext</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">alpha</span><span class="p">):</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">range_text</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
                <span class="n">text</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span>
                <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">),</span>
                <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;&lt;-&gt;&quot;</span><span class="p">,</span> <span class="n">shrinkA</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">shrinkB</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
                <span class="n">x1</span> <span class="o">+</span> <span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
                <span class="mf">1.01</span> <span class="o">*</span> <span class="n">y1</span> <span class="o">+</span> <span class="p">(</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
                <span class="n">text</span><span class="p">,</span>
                <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                <span class="n">va</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">axvspan</span><span class="p">(</span><span class="n">xl</span><span class="p">,</span> <span class="n">xu</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
        <span class="n">range_text</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">xl</span><span class="p">,</span> <span class="n">ytext</span><span class="p">,</span> <span class="n">xu</span><span class="p">,</span> <span class="n">ytext</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>

<div class="viewcode-block" id="GenericCalibration.plot_region"><a class="viewcode-back" href="../../gen/pystra.calibration.GenericCalibration.html#pystra.calibration.GenericCalibration.plot_region">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_region</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">facecolor</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots a region of reliability indices, and adds a line for the smallest</span>
<span class="sd">        dead load ratio.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ax : Matplotlib Axes object</span>
<span class="sd">            The axes to plot on.</span>
<span class="sd">        x : nd.array</span>
<span class="sd">            Vector of live load ratio points.</span>
<span class="sd">        beta : nd.array</span>
<span class="sd">            Matrix of reliability indices correspond go the dead and live ratios grid.</span>
<span class="sd">        facecolor : str</span>
<span class="sd">            Matplotlib string description of a colour.</span>
<span class="sd">        label : str</span>
<span class="sd">            Label for the plot legend.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
            <span class="n">x</span><span class="p">,</span>
            <span class="n">beta</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
            <span class="n">beta</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="n">facecolor</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">beta</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">facecolor</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="GenericCalibration.beta_region_plot"><a class="viewcode-back" href="../../gen/pystra.calibration.GenericCalibration.html#pystra.calibration.GenericCalibration.beta_region_plot">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">beta_region_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Aq</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">beta_t</span><span class="p">,</span> <span class="n">ranges</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The main plotting function.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        Aq : nd.array</span>
<span class="sd">            Vector of live load ratio points..</span>
<span class="sd">        data : List[Dict{GemericModel}]</span>
<span class="sd">            List of dictionaries of GenericModels, plotting info, and results.</span>
<span class="sd">        beta_t : float</span>
<span class="sd">            Target reliability index.</span>
<span class="sd">        ranges : Dict</span>
<span class="sd">            A dictionary of range information with the following keys:</span>
<span class="sd">                xl, xu, ytext, text, alpha</span>
<span class="sd">            defining the lower and upper aq values, the position of the text, the text,</span>
<span class="sd">            and the alpha of the range colouring.</span>
<span class="sd">        figsize : Tuple(float), optional</span>
<span class="sd">            The figure size in inches. The default is (12, 9).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig : Matplotlib Figure object</span>
<span class="sd">            The figure.</span>
<span class="sd">        ax : Matplotlib Axes object</span>
<span class="sd">            The axes.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">Aq</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_axisbelow</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ranges</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">ranges</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_range</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">r</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_region</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;betas&quot;</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">beta_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.99</span> <span class="o">*</span> <span class="n">beta_t</span><span class="p">,</span> <span class="sa">rf</span><span class="s2">&quot;$\beta_T = </span><span class="si">{</span><span class="n">beta_t</span><span class="si">}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">set_bbox</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Variable load ratio, $a_q = Q/(G+P+Q)$&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Reliability index, $\beta$&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span></div>

<div class="viewcode-block" id="GenericCalibration.plot"><a class="viewcode-back" href="../../gen/pystra.calibration.GenericCalibration.html#pystra.calibration.GenericCalibration.plot">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">beta_t</span><span class="o">=</span><span class="mf">4.7</span><span class="p">,</span> <span class="n">ranges</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot the region for each probability model with their descriptions.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        beta_t : float</span>
<span class="sd">            Target reliability index.</span>
<span class="sd">        ranges : Dict</span>
<span class="sd">            A dictionary of range information with the following keys:</span>
<span class="sd">                xl, xu, ytext, text, alpha</span>
<span class="sd">            defining the lower and upper aq values, the position of the text, the text,</span>
<span class="sd">            and the alpha of the range colouring.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If there are no analysis results.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig,ax : Tuple(Matplotlib Figure, Matplotlib Axes)</span>
<span class="sd">            The figure and axes.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_analysed</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Must be analysed before plotting&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta_region_plot</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">aq_points</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">prob_models</span><span class="p">,</span> <span class="n">beta_t</span><span class="p">,</span> <span class="n">ranges</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span></div></div>
</pre></div>

                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2023, The PySTRA Developers.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.1.2.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.14.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>